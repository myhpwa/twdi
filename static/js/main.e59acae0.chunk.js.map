{"version":3,"sources":["../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","Globals.tsx","redux/reducers/index.tsx","redux/reducers/setReducer.tsx","redux/reducers/tmpSetReducer.tsx","pages/SettingsPage.tsx","pages/BookmarkPage.tsx","pages/DictionaryPage.tsx","components/ShareTextModal.tsx","components/DownloadModal.tsx","models/Bookmark.tsx","models/DictItem.tsx","models/ChineseHerbItem.tsx","pages/DrugPage.tsx","App.tsx","redux/store.tsx","serviceWorkerRegistration.ts","index.tsx"],"names":["map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","keys","Object","module","exports","pwaUrl","process","twdiDb","log","url","progressCallback","a","ok","fail","twdData","dl","DownloaderHelper","progressUpdateEnable","on","stats","progress","setTimeout","downloadInfo","removeAllListeners","zipEntry","AdmZip","filePath","getEntries","JSON","parse","getData","toString","start","fileName","dbOpenReq","indexedDB","open","onsuccess","ev","db","result","trans","transaction","objectStore","get","_ev","data","console","error","stack","err","transWrite","reqWrite","put","onerror","delete","clearIndexedDB","clear","localStorage","consoleLog","bind","consoleError","window","webkit","isMacCatalyst","isPlatform","navigator","platform","oldStoreFile","newStoreFile","savedSettingsStr","getItem","setItem","removeItem","Globals","bugReportApiUrl","storeFile","downloadTwdData","getLog","enableAppLog","Array","from","arguments","apply","disableAppLog","durgResources","item","dataKey","appSettings","fetchErrorContent","className","style","fontSize","paddingTop","href","target","updateApp","serviceWorker","getRegistrations","regs","all","reg","update","newReg","installing","waiting","hasUpdates","reduce","prev","curr","updateCssVars","settings","document","documentElement","cssText","uiFontSize","isTouchDevice","isStoreApps","dictItems","chineseHerbsItems","getFileFromIndexedDB","saveFileToIndexedDB","removeFileFromIndexedDB","clearAppData","removeElementsByClassName","doc","elements","getElementsByClassName","length","parentNode","removeChild","disableAndroidChromeCallout","event","preventDefault","stopPropagation","disableIosSafariCallout","s","this","getSelection","rangeCount","r","getRangeAt","removeAllRanges","addRange","copyToClipboard","text","clipboard","writeText","combineReducers","state","action","newSettings","type","key","val","body","classList","forEach","test","remove","toggle","stringify","bookmarks","bookmark","bookmarksTemp","idxToDel","findIndex","b","uuid","splice","vals","k","undefined","tmpSettings","newState","_SettingsPage","props","reportText","showBugReportAlert","showFontLicense","twdDataDownloadRatio","showUpdateDrugDataDone","showClearAlert","showToast","toastMessage","newBookmarks","newBookmark","updateIndex","setState","i","hidden","mainVersion","tabIndex","icon","informationCircle","slot","bug","checked","hasAppLog","onIonChange","isChecked","detail","dispatch","fill","shape","size","onClick","userAgent","PackageInfos","pwaVersion","cssClass","backdropDismiss","isOpen","header","subHeader","inputs","name","placeholder","buttons","handler","value","name0","axiosInstance","axios","create","timeout","post","subject","productName","name1","role","download","flexDirection","textAlign","settingsJsonUri","encodeURIComponent","createElement","click","accept","display","onChange","file","files","fileText","updateDrugData","getElementById","querySelector","onDidPresent","theme","refreshCircle","width","onDidDismiss","message","duration","colorPalette","interface","interfaceOptions","min","max","pin","snaps","helpCircle","React","Component","SettingsPage","withIonLifeCycle","connect","speechRate","voiceURI","helpDoc","_BookmarkPage","bookmarkListRef","reorder","createRef","queryParams","queryString","location","search","history","push","isChineseHerb","hasBookmark","uuidStr","complete","rows","routeLink","label","中文品名","button","pathname","side","color","delBookmarkHandler","current","closeSlidingItems","getBookmarkRows","swapVertical","ref","disabled","onIonItemReorder","reorderBookmarks","BookmarkPage","_DictionaryPage","searchBarRef","filteredData","mode","page","keyword","searches","showNoSelectedTextAlert","popover","show","isScrollOn","fetchError","match","params","newSearch","timer","setInterval","loadingTwdData","clearInterval","re","RegExp","filter","dictItem","通關簽審文件編號","英文品名","製造商名稱","主成分略述","藥品名稱","處方成分","許可證字號","slice","dictionaryHistory","unshift","index","drugId","exec","isTopPage","goBack","arrowBack","decodeURIComponent","shareSocial","onIonClear","onKeyUp","getRows","threshold","onIonInfinite","loadingText","DictionaryPage","_ShareTextModal","isAppSettingsExport","appSettingsString","keyVal","join","appUrl","hasQueryString","qrcCanvas","qrcode","showModal","swipeToClose","onWillPresent","updateQrCode","finish","height","alignItems","flexGrow","flexShrink","margin","_DownloadModal","Math","floor","Bookmark","json","DictItem","適應症","劑型","管制藥品分類級別","用法用量","包裝","包裝與國際條碼","有效日期","發證日期","許可證種類","舊證字號","藥品類別","異動日期","申請商名稱","申請商地址","申請商統一編號","製造廠國別","製造廠廠址","製造廠公司地址","製程","註銷狀態","註銷日期","註銷理由","sortedKeys","ChineseHerbItem","限制項目","劑型與類別","適應症及效能","藥商名稱","製造商地址","單複方","_DrugPage","lookupDict","tab","chineseHerbIdPattern","res","find","dictView","addBookmarkHandler","DrugPage","electronBackendApi","store","createStore","reducer","getSavedStore","setupConfig","swipeBackEnabled","serviceWorkCallbacks","onSuccess","registration","onUpdate","_App","AppOrig","_AppOrig","registrationNew","originalAppSettingsStr","wakeLock","receive","version","send","split","setting","showUpdateAlert","showRestoreAppSettingsToast","showDataDownloadEndAlert","downloadModal","speechSynthesis","getVoices","cancel","wakeLockScreen","addEventListener","visibilityState","wakeLockScreenRelease","onupgradeneeded","createObjectStore","loadTwdData","request","release","routeMatches","queryMatches","route","query","to","animated","path","render","exact","routeByQueryString","postMessage","ShareTextModal","shareTextModal","DownloadModal","restoreAppSettings","App","withRouter","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","register","onupdatefound","installingWorker","onstatechange","controller","catch","ReactDOM","URL","origin","fetch","headers","response","contentType","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"qgHAAA,IAAIA,EAAM,CACT,8BAA+B,CAC9B,IACA,GAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,GAED,0BAA2B,CAC1B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,sBAAuB,CACtB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,qBAAsB,CACrB,IACA,IAED,mCAAoC,CACnC,IACA,IAED,uBAAwB,CACvB,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,IAED,yBAA0B,CACzB,IACA,GAED,8BAA+B,CAC9B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,sBAAuB,CACtB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,gCAAiC,CAChC,IACA,KAGF,SAASC,EAAoBC,GAC5B,IAAIC,EAAoBC,EAAEJ,EAAKE,GAC9B,OAAOG,QAAQC,UAAUC,MAAK,WAC7B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBP,EAAM,KAEjD,MADAM,EAAEE,KAAO,mBACHF,KAIR,IAAIG,EAAMX,EAAIE,GAAMU,EAAKD,EAAI,GAC7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","file":"static/js/main.e59acae0.chunk.js","sourcesContent":["var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t430,\n\t\t5\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t431,\n\t\t6\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t432,\n\t\t7\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t433,\n\t\t17\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t434,\n\t\t18\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t435,\n\t\t43\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t436,\n\t\t19\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t437,\n\t\t20\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t438,\n\t\t21\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t439,\n\t\t22\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t440,\n\t\t44\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t441,\n\t\t10\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t442,\n\t\t23\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t443,\n\t\t45\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t444,\n\t\t46\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t445,\n\t\t24\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t446,\n\t\t25\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t447,\n\t\t26\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t448,\n\t\t27\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t449,\n\t\t28\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t450,\n\t\t8\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t451,\n\t\t14\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t452,\n\t\t9\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t453,\n\t\t29\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t454,\n\t\t30\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t455,\n\t\t31\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t456,\n\t\t11\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t457,\n\t\t16\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t458,\n\t\t47\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t459,\n\t\t32\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t460,\n\t\t33\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t461,\n\t\t34\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t462,\n\t\t35\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t463,\n\t\t48\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t464,\n\t\t13\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t465,\n\t\t49\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t466,\n\t\t36\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t467,\n\t\t15\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t468,\n\t\t37\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t469,\n\t\t38\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t470,\n\t\t39\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t471,\n\t\t12\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t472,\n\t\t50\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 223;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t473,\n\t\t57\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 225;\nmodule.exports = webpackAsyncContext;","import { isPlatform, IonLabel } from '@ionic/react';\nimport * as AdmZip from 'adm-zip';\nimport { DownloaderHelper, Stats } from 'node-downloader-helper';\nimport { ChineseHerbItem } from './models/ChineseHerbItem';\nimport { DictItem } from './models/DictItem';\n\nconst pwaUrl = process.env.PUBLIC_URL || '';\nconst bugReportApiUrl = 'https://vh6ud1o56g.execute-api.ap-northeast-1.amazonaws.com/bugReportMailer';\nlet twdDataUrl = `https://myhdata.s3.ap-northeast-1.amazonaws.com/全部藥品許可證資料集.zip`;\nlet twchDataUrl = `https://myhdata.s3.ap-northeast-1.amazonaws.com/中藥藥品許可證資料集.zip`;\n\nconst twdiDb = 'twdiDb';\nconst twdDataKey = 'twdData';\nconst twchDataKey = 'twchData';\nlet log = '';\n\nvar dictItems: Array<DictItem> = [];\nvar chineseHerbsItems: Array<ChineseHerbItem> = [];\n\nasync function downloadTwdData(url: string, progressCallback: Function) {\n  return new Promise((ok, fail) => {\n    let twdData: any;\n    const dl = new DownloaderHelper(url, '.', {});\n    let progressUpdateEnable = true;\n    dl.on('progress', (stats: Stats) => {\n      if (progressUpdateEnable) {\n        // Reduce number of this calls by progressUpdateEnable.\n        // Too many of this calls could result in 'end' event callback is executed before 'progress' event callbacks!\n        progressCallback(stats.progress);\n        progressUpdateEnable = false;\n        setTimeout(() => {\n          progressUpdateEnable = true;\n        }, 100);\n      }\n    });\n    dl.on('end', (downloadInfo: any) => {\n      dl.removeAllListeners();\n      const zip = new AdmZip.default(downloadInfo.filePath);\n      const zipEntry = zip.getEntries()[0];\n      twdData = JSON.parse(zipEntry.getData().toString(\"utf8\"));\n      ok(twdData);\n    });\n    dl.start();\n  });\n}\n\nasync function getFileFromIndexedDB(fileName: string) {\n  const dbOpenReq = indexedDB.open(twdiDb);\n\n  return new Promise(function (ok, fail) {\n    dbOpenReq.onsuccess = async function (ev) {\n      const db = dbOpenReq.result;\n\n      try {\n        const trans = db.transaction([\"store\"], 'readwrite');\n        let req = trans.objectStore('store').get(fileName);\n        req.onsuccess = async function (_ev) {\n          const data = req.result;\n          if (!data) {\n            console.error(`${fileName} loading failed!`);\n            console.error(new Error().stack);\n            return fail();\n          }\n          return ok(data);\n        };\n      } catch (err) {\n        console.error(err);\n      }\n    };\n  });\n}\n\nasync function saveFileToIndexedDB(fileName: string, data: any) {\n  const dbOpenReq = indexedDB.open(twdiDb);\n  return new Promise<void>((ok, fail) => {\n    dbOpenReq.onsuccess = async (ev: Event) => {\n      const db = dbOpenReq.result;\n\n      const transWrite = db.transaction([\"store\"], 'readwrite')\n      const reqWrite = transWrite.objectStore('store').put(data, fileName);\n      reqWrite.onsuccess = (_ev: any) => ok();\n      reqWrite.onerror = (_ev: any) => fail();\n    };\n  });\n}\n\nasync function removeFileFromIndexedDB(fileName: string) {\n  const dbOpenReq = indexedDB.open(twdiDb);\n  return new Promise<void>((ok, fail) => {\n    try {\n      dbOpenReq.onsuccess = (ev: Event) => {\n        const db = dbOpenReq.result;\n\n        const transWrite = db.transaction([\"store\"], 'readwrite')\n        try {\n          const reqWrite = transWrite.objectStore('store').delete(fileName);\n          reqWrite.onsuccess = (_ev: any) => ok();\n          reqWrite.onerror = (_ev: any) => fail();\n        } catch (err) {\n          console.error(err);\n        }\n      };\n    } catch (err) {\n      fail(err);\n    }\n  });\n}\n\nasync function clearIndexedDB() {\n  const dbOpenReq = indexedDB.open(twdiDb);\n  return new Promise<void>((ok, fail) => {\n    dbOpenReq.onsuccess = async (ev: Event) => {\n      const db = dbOpenReq.result;\n\n      const transWrite = db.transaction([\"store\"], 'readwrite')\n      const reqWrite = transWrite.objectStore('store').clear();\n      reqWrite.onsuccess = (_ev: any) => ok();\n      reqWrite.onerror = (_ev: any) => fail();\n    };\n  });\n}\n\nasync function clearAppData() {\n  localStorage.clear();\n  await clearIndexedDB();\n}\n\n//const electronBackendApi: any = (window as any).electronBackendApi;\n\nfunction removeElementsByClassName(doc: Document, className: string) {\n  let elements = doc.getElementsByClassName(className);\n  while (elements.length > 0) {\n    elements[0].parentNode?.removeChild(elements[0]);\n  }\n}\n\nconst consoleLog = console.log.bind(console);\nconst consoleError = console.error.bind(console);\n\nfunction getLog() {\n  return log;\n}\n\nfunction enableAppLog() {\n  console.log = function () {\n    log += '----- Info ----\\n';\n    log += (Array.from(arguments)) + '\\n';\n    consoleLog.apply(console, arguments as any);\n  };\n\n  console.error = function () {\n    log += '----- Error ----\\n';\n    log += (Array.from(arguments)) + '\\n';\n    consoleError.apply(console, arguments as any);\n  };\n}\n\nfunction disableAppLog() {\n  log = '';\n  console.log = consoleLog;\n  console.error = consoleError;\n}\n\nfunction disableAndroidChromeCallout(event: any) {\n  event.preventDefault();\n  event.stopPropagation();\n  return false;\n}\n\n// Workable but imperfect.\nfunction disableIosSafariCallout(this: Window, event: any) {\n  const s = this.getSelection();\n  if ((s?.rangeCount || 0) > 0) {\n    const r = s?.getRangeAt(0);\n    s?.removeAllRanges();\n    setTimeout(() => {\n      s?.addRange(r!);\n    }, 50);\n  }\n}\n\nconst webkit = (window as any).webkit;\nfunction copyToClipboard(text: string) {\n  try {\n    navigator.clipboard && navigator.clipboard.writeText(text);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction isMacCatalyst() {\n  return isPlatform('ios') && navigator.platform === 'MacIntel';\n}\n\n// Migrate old store file to new one.\nconst oldStoreFile = 'Settings.json';\nconst newStoreFile = 'twdiSettings.json';\nconst savedSettingsStr = localStorage.getItem(oldStoreFile);\nif (savedSettingsStr != null) {\n  localStorage.setItem(newStoreFile, savedSettingsStr);\n  localStorage.removeItem(oldStoreFile);\n}\n\nconst Globals = {\n  pwaUrl,\n  bugReportApiUrl,\n  storeFile: newStoreFile,\n  downloadTwdData,\n  getLog,\n  enableAppLog,\n  disableAppLog,\n  twdiDb,\n  durgResources: [\n    { item: \"離線西藥資料\", dataKey: twdDataKey, url: twdDataUrl },\n    { item: \"離線中藥資料\", dataKey: twchDataKey, url: twchDataUrl },\n  ],\n  appSettings: {\n    'theme': '佈景主題',\n    'uiFontSize': 'UI 字型大小',\n    'fontSize': '內容字型大小',\n  } as Record<string, string>,\n  fetchErrorContent: (\n    <div className='contentCenter'>\n      <IonLabel>\n        <div>\n          <div>連線失敗!</div>\n          <div style={{ fontSize: 'var(--ui-font-size)', paddingTop: 24 }}>如果問題持續發生，請執行<a href={`/${pwaUrl}/settings`} target=\"_self\">設定頁</a>的 app 異常回報功能。</div>\n        </div>\n      </IonLabel>\n    </div>\n  ),\n  updateApp: () => {\n    return new Promise(async resolve => {\n      navigator.serviceWorker.getRegistrations().then(async regs => {\n        const hasUpdates = await Promise.all(regs.map(reg => (reg.update() as any).then((newReg: ServiceWorkerRegistration) => {\n          return newReg.installing !== null || newReg.waiting !== null;\n        })));\n        resolve(hasUpdates.reduce((prev, curr) => prev || curr, false));\n      });\n    });\n  },\n  updateCssVars: (settings: any) => {\n    document.documentElement.style.cssText = `--ui-font-size: ${settings.uiFontSize}px; --text-font-size: ${settings.fontSize}px`\n  },\n  isMacCatalyst,\n  isTouchDevice: () => {\n    return (isPlatform('ios') && !isMacCatalyst()) || isPlatform('android');\n  },\n  isStoreApps: () => {\n    return isPlatform('pwa') || isPlatform('electron');\n  },\n  dictItems,\n  chineseHerbsItems,\n  getFileFromIndexedDB,\n  saveFileToIndexedDB,\n  removeFileFromIndexedDB,\n  clearAppData,\n  removeElementsByClassName,\n  disableAndroidChromeCallout,\n  disableIosSafariCallout,\n  copyToClipboard,\n};\n\nexport default Globals;\n","import { combineReducers } from \"redux\"\n\nimport settings from \"./setReducer\"\nimport tmpSettings from \"./tmpSetReducer\"\n\nexport default combineReducers({\n  settings, tmpSettings\n})\n","import Globals from '../../Globals';\nimport { Bookmark } from '../../models/Bookmark';\n\n// Used to store settings. They will be saved to file.\nexport default function reducer(state = {\n}, action: any) {\n  var newSettings = { ...state } as any;\n  switch (action.type) {\n    case \"LOAD_SETTINGS\":\n      newSettings = JSON.parse(localStorage.getItem(Globals.storeFile)!).settings;\n      break;\n    case \"SET_KEY_VAL\":\n      var key = action.key;\n      var val = action.val;\n      switch (key) {\n        case 'theme': {\n          document.body.classList.forEach((val) => {\n            if (/theme/.test(val)) {\n              document.body.classList.remove(val);\n            }\n          });\n          document.body.classList.toggle(`theme${val}`, true);\n          break;\n        }\n      }\n\n      newSettings[key] = val;\n      localStorage.setItem(Globals.storeFile, JSON.stringify({ settings: newSettings }));\n      break;\n    case \"ADD_BOOKMARK\":\n      newSettings.bookmarks = [...newSettings.bookmarks, action.bookmark];\n      localStorage.setItem(Globals.storeFile, JSON.stringify({ settings: newSettings }));\n      break;\n    case \"DEL_BOOKMARK\": {\n      let bookmarksTemp = newSettings.bookmarks as [Bookmark];\n      const idxToDel = bookmarksTemp.findIndex((b) => { return b.uuid === action.uuid });\n      if (idxToDel !== -1) {\n        bookmarksTemp.splice(idxToDel, 1);\n      }\n      newSettings.bookmarks = [...bookmarksTemp];\n      localStorage.setItem(Globals.storeFile, JSON.stringify({ settings: newSettings }));\n      break;\n    }\n    case \"UPDATE_BOOKMARKS\": {\n      newSettings.bookmarks = action.bookmarks;\n      localStorage.setItem(Globals.storeFile, JSON.stringify({ settings: newSettings }));\n      break;\n    }\n    // @ts-ignore\n    case \"DEFAULT_SETTINGS\":\n      newSettings = {};\n    // Don't use break here!\n    // eslint-disable-next-line\n    default:\n      if (Object.keys(newSettings).length === 0) {\n        newSettings = {};\n      }\n      // Setting default values.\n      // version is the setting file version.\n      var keys = ['version', 'hasAppLog', 'theme', 'fontSize', 'uiFontSize', 'voiceURI', 'speechRate', 'bookmarks', 'dictionaryHistory'];\n      var vals = [1, 1, 0, 32, 24, null, 0.8, [], []];\n      for (let k = 0; k < keys.length; k++) {\n        if (newSettings[keys[k]] === undefined) {\n          newSettings[keys[k]] = vals[k];\n        }\n      }\n  }\n  return newSettings;\n}\n","// Used to store temp settings in RAM. They will not be saved to file.\nexport default function reducer(state = {\n}, action: any) {\n  var newState = { ...state } as any;\n  var key = action.key;\n  var val = action.val;\n  newState[key] = val;\n  switch (action.type) {\n    case \"TMP_SET_KEY_VAL\": {\n      return newState;\n    }\n    default:\n      break;\n  }\n  return state;\n}\n","import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonList, IonItem, IonRange, IonIcon, IonLabel, IonToggle, IonButton, IonAlert, IonSelect, IonSelectOption, IonToast, withIonLifeCycle, IonProgressBar } from '@ionic/react';\nimport { connect } from 'react-redux';\nimport { RouteComponentProps } from 'react-router-dom';\nimport Globals from '../Globals';\nimport { helpCircle, text, refreshCircle, colorPalette, bug, download, informationCircle } from 'ionicons/icons';\nimport axios from 'axios';\n\nimport './SettingsPage.css';\nimport PackageInfos from '../../package.json';\nimport { Bookmark, } from '../models/Bookmark';\n\ninterface StateProps {\n  showBugReportAlert: boolean;\n  showFontLicense: boolean;\n  twdDataDownloadRatio: number;\n  showUpdateDrugDataDone: boolean;\n  showClearAlert: boolean;\n  showToast: boolean;\n  toastMessage: string;\n}\n\ninterface Props {\n  dispatch: Function;\n  hasAppLog: boolean;\n  theme: number;\n  uiFontSize: number;\n  settings: any;\n  voiceURI: string;\n  speechRate: number;\n  bookmarks: [Bookmark];\n  mainVersion: string | null;\n  cbetaOfflineDbMode: boolean;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n  label: string;\n}> { }\n\nclass _SettingsPage extends React.Component<PageProps, StateProps> {\n  constructor(props: any) {\n    super(props);\n\n    this.state = {\n      showBugReportAlert: false,\n      showFontLicense: false,\n      twdDataDownloadRatio: 0,\n      showUpdateDrugDataDone: false,\n      showClearAlert: false,\n      showToast: false,\n      toastMessage: '',\n    };\n  }\n\n  ionViewWillEnter() {\n  }\n\n  updateBookmark(newBookmarks: Array<Bookmark>, newBookmark: Bookmark) {\n    const updateIndex = newBookmarks.findIndex((b: Bookmark) => b.uuid === newBookmark.uuid);\n    if (updateIndex === -1) {\n      console.error(`Update bookmark fails! Can't find the original bookmark with UUID: ${newBookmark.uuid}`);\n    } else {\n      newBookmarks[updateIndex] = newBookmark;\n    }\n    return;\n  }\n\n  async updateDrugData() {\n    this.setState({ twdDataDownloadRatio: 0 });\n    for (let i = 0; i < Globals.durgResources.length; i++) {\n      let item = Globals.durgResources[i];\n      const twdData = await Globals.downloadTwdData(item.url, (progress: number) => {\n        this.setState({ twdDataDownloadRatio: (i + (progress / 100)) / Globals.durgResources.length });\n      });\n      Globals.saveFileToIndexedDB(item.dataKey, twdData);\n    }\n    this.setState({ twdDataDownloadRatio: 1, showUpdateDrugDataDone: true });\n  }\n\n  reportText = '';\n  render() {\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonTitle className='uiFont'>設定</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          <IonList>\n            {/*\n              // Disable app update for Mac App Store submission.\n            <IonItem>\n              <IonIcon icon={shareSocial} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont' onClick={async e => {\n                const hasUpdate = await Globals.updateApp();\n\n                if (!hasUpdate) {\n                  this.setState({ showToast: true, toastMessage: 'App 已是最新版' });\n                }\n              }}>PWA版本: <a href=\"https://github.com/MrMYHuang/twdi#history\" target=\"_new\">{PackageInfos.pwaVersion}</a></IonLabel>\n              <IonButton fill='outline' shape='round' slot='end' size='large' style={{ fontSize: 'var(--ui-font-size)' }} onClick={e => {\n                this.props.dispatch({\n                  type: \"TMP_SET_KEY_VAL\",\n                  key: 'shareTextModal',\n                  val: {\n                    show: true,\n                    text: window.location.origin,\n                  },\n                });\n              }}>分享</IonButton>\n            </IonItem>\n            */}\n            <IonItem hidden={!this.props.mainVersion}>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={informationCircle} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>Backend app 版本: {this.props.mainVersion}</IonLabel>\n              {/*<IonButton fill='outline' shape='round' slot='end' size='large' style={{ fontSize: 'var(--ui-font-size)' }} onClick={e => {\n              }}>分享</IonButton>*/}\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={bug} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'><a href=\"https://github.com/MrMYHuang/twdi#report\" target=\"_new\">啟用 app 異常記錄</a></IonLabel>\n              <IonToggle slot='end' checked={this.props.hasAppLog} onIonChange={e => {\n                const isChecked = e.detail.checked;\n\n                if (this.props.hasAppLog === isChecked) {\n                  return;\n                }\n\n                isChecked ? Globals.enableAppLog() : Globals.disableAppLog();\n                this.props.dispatch({\n                  type: \"SET_KEY_VAL\",\n                  key: 'hasAppLog',\n                  val: isChecked\n                });\n              }} />\n            </IonItem>\n            <IonItem hidden={!this.props.settings.hasAppLog}>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={bug} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>回報 app 異常記錄</IonLabel>\n              <IonButton fill='outline' shape='round' slot='end' size='large' className='uiFont' onClick={e => {\n                this.reportText = \"瀏覽器：\" + navigator.userAgent + \"\\n\\nApp版本：\" + PackageInfos.pwaVersion + \"\\n\\nApp設定：\" + JSON.stringify(this.props.settings) + \"\\n\\nLog：\\n\" + Globals.getLog();\n                this.setState({ showBugReportAlert: true });\n              }}>回報</IonButton>\n              <IonAlert\n                cssClass='uiFont'\n                backdropDismiss={false}\n                isOpen={this.state.showBugReportAlert}\n                header={'異常回報'}\n                subHeader='輸入您的 E-mail，以後續聯絡'\n                inputs={[\n                  {\n                    name: 'name0',\n                    type: 'email',\n                    placeholder: '例：abc@example.com'\n                  },\n                  {\n                    name: 'name1',\n                    type: 'textarea',\n                    placeholder: '請描述發生步驟'\n                  },\n                ]}\n                buttons={[\n                  {\n                    text: '送出',\n                    cssClass: 'primary uiFont',\n                    handler: async (value) => {\n                      if (!/^\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$/.test(value.name0)) {\n                        this.setState({ showBugReportAlert: false, showToast: true, toastMessage: `錯誤，E-mail 不符格式！` });\n                        return\n                      }\n\n                      try {\n                        const axiosInstance = axios.create({ timeout: 10000 });\n                        await axiosInstance.post(Globals.bugReportApiUrl, {\n                          subject: `${PackageInfos.productName}異常記錄回報`,\n                          text: `E-mail: ${value.name0}\\n\\n發生步驟: ${value.name1}\\n\\n${this.reportText}`,\n                        });\n                        this.setState({ showBugReportAlert: false, showToast: true, toastMessage: `異常回報成功` });\n                      } catch (error) {\n                        console.error(error);\n                        this.setState({ showBugReportAlert: false, showToast: true, toastMessage: `異常回報失敗` });\n                      }\n                    },\n                  },\n                  {\n                    text: '取消',\n                    role: 'cancel',\n                    cssClass: 'secondary uiFont',\n                    handler: () => this.setState({ showBugReportAlert: false }),\n                  },\n                ]}\n              />\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={download} slot='start' />\n              <div className='contentBlock'>\n                <div style={{ flexDirection: 'column' }}>\n                  <IonLabel className='ion-text-wrap uiFont'>App設定與書籤</IonLabel>\n                  <div style={{ textAlign: 'right' }}>\n                    <IonButton fill='outline' shape='round' size='large' style={{ fontSize: 'var(--ui-font-size)' }} onClick={async (e) => {\n                      const settingsJsonUri = `data:text/json;charset=utf-8,${encodeURIComponent(localStorage.getItem(Globals.storeFile) || '')}`;\n                      const a = document.createElement('a');\n                      a.href = settingsJsonUri;\n                      a.download = Globals.storeFile;\n                      a.click();\n                      a.remove();\n                    }}>匯出</IonButton>\n                    <input id='importJsonInput' type='file' accept='.json' style={{ display: 'none' }} onChange={async (ev) => {\n                      const file = ev.target.files?.item(0);\n                      const fileText = await file?.text() || '';\n                      try {\n                        // JSON text validation.\n                        JSON.parse(fileText);\n                        localStorage.setItem(Globals.storeFile, fileText);\n                        this.props.dispatch({ type: 'LOAD_SETTINGS' });\n                        this.updateDrugData();\n                      } catch (e) {\n                        console.error(e);\n                        console.error(new Error().stack);\n                      }\n                      (document.getElementById('importJsonInput') as HTMLInputElement).value = '';\n                    }} />\n\n                    <IonButton fill='outline' shape='round' size='large' style={{ fontSize: 'var(--ui-font-size)' }} onClick={(e) => {\n                      (document.querySelector('#importJsonInput') as HTMLInputElement).click();\n                    }}>匯入</IonButton>\n                    <IonButton fill='outline' shape='round' size='large' style={{ fontSize: 'var(--ui-font-size)' }} onClick={(e) => {\n                      this.setState({ showClearAlert: true });\n                    }}>重置</IonButton>\n                    <IonAlert\n                      cssClass='uiFont'\n                      isOpen={this.state.showClearAlert}\n                      backdropDismiss={false}\n                      onDidPresent={(ev) => {\n                      }}\n                      header={'重置會還原app設定預設值並清除書籤、離線資料檔！確定重置？'}\n                      buttons={[\n                        {\n                          text: '取消',\n                          cssClass: 'primary uiFont',\n                          handler: (value) => {\n                            this.setState({\n                              showClearAlert: false,\n                            });\n                          },\n                        },\n                        {\n                          text: '重置',\n                          cssClass: 'secondary uiFont',\n                          handler: async (value) => {\n                            await Globals.clearAppData();\n                            this.props.dispatch({ type: 'DEFAULT_SETTINGS' });\n                            while (document.body.classList.length > 0) {\n                              document.body.classList.remove(document.body.classList.item(0)!);\n                            }\n                            document.body.classList.toggle(`theme${this.props.theme}`, true);\n                            this.setState({ showClearAlert: false, showToast: true, toastMessage: \"清除成功!\" });\n                          },\n                        }\n                      ]}\n                    />\n                  </div>\n                </div>\n              </div>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={refreshCircle} slot='start' />\n              <div style={{ width: '100%' }}>\n                <IonLabel className='ion-text-wrap uiFont'>更新離線藥品資料</IonLabel>\n                <IonProgressBar value={this.state.twdDataDownloadRatio} />\n              </div>\n              <IonButton fill='outline' shape='round' slot='end' size='large' style={{ fontSize: 'var(--ui-font-size)' }} onClick={async (e) => this.updateDrugData()}>更新</IonButton>\n              <IonToast\n                cssClass='uiFont'\n                isOpen={this.state.showUpdateDrugDataDone}\n                onDidDismiss={() => this.setState({ showUpdateDrugDataDone: false })}\n                message={`離線藥品資料更新完畢！`}\n                duration={2000}\n              />\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={colorPalette} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings['theme']}</IonLabel>\n              <IonSelect slot='end'\n                value={+this.props.theme}\n                style={{ fontSize: 'var(--ui-font-size)' }}\n                interface='popover'\n                interfaceOptions={{ cssClass: 'twdithemes' }}\n                onIonChange={e => {\n                  const value = +e.detail.value;\n                  // Important! Because it can results in rerendering of this component but\n                  // store states (this.props.theme) of this component is not updated yet! And IonSelect value will be changed\n                  // back to the old value and onIonChange will be triggered again!\n                  // Thus, we use this check to ignore this invalid change.\n                  if (+this.props.theme === value) {\n                    return;\n                  }\n\n                  this.props.dispatch({\n                    type: \"SET_KEY_VAL\",\n                    key: 'theme',\n                    val: value,\n                  });\n                }}>\n                <IonSelectOption className='uiFont cbeta' value={0}>綠底</IonSelectOption>\n                <IonSelectOption className='uiFont dark' value={1}>暗色</IonSelectOption>\n                <IonSelectOption className='uiFont light' value={2}>亮色</IonSelectOption>\n                <IonSelectOption className='uiFont oldPaper' value={3}>舊書</IonSelectOption>\n                <IonSelectOption className='uiFont marble' value={4}>大理石</IonSelectOption>\n              </IonSelect>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={text} slot='start' />\n              <div className=\"contentBlock\">\n                <div style={{ flexDirection: \"column\" }}>\n                  <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings['uiFontSize']}: {this.props.uiFontSize}</IonLabel>\n                  <IonRange min={10} max={128} pin={true} snaps={true} value={this.props.uiFontSize} onIonChange={e => {\n                    this.props.dispatch({\n                      type: \"SET_KEY_VAL\",\n                      key: 'uiFontSize',\n                      val: +e.detail.value,\n                    });\n                    Globals.updateCssVars(this.props.settings);\n                  }} />\n                </div>\n              </div>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={text} slot='start' />\n              <div className=\"contentBlock\">\n                <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings['fontSize']}: <span className='textFont'>{this.props.settings.fontSize}</span></IonLabel>\n                <IonRange min={10} max={128} pin={true} snaps={true} value={this.props.settings.fontSize} onIonChange={e => {\n                  this.props.dispatch({\n                    type: \"SET_KEY_VAL\",\n                    key: 'fontSize',\n                    val: +e.detail.value,\n                  });\n                  Globals.updateCssVars(this.props.settings);\n                }} />\n              </div>\n            </IonItem>\n            {/*\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. * /}\n              <IonIcon icon={print} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>合成語音</IonLabel>\n              <IonSelect slot='end'\n                value={this.props.voiceURI}\n                style={{ fontSize: 'var(--ui-font-size)' }}\n                interface='action-sheet'\n                cancelText='取消'\n                onIonChange={e => {\n                  const value = e.detail.value;\n                  if (this.props.voiceURI === value) {\n                    return;\n                  }\n\n                  this.props.dispatch({\n                    type: \"SET_KEY_VAL\",\n                    key: 'voiceURI',\n                    val: value,\n                  });\n                }}>\n                {\n                  Globals.zhVoices().map((v, i) => <IonSelectOption key={i} className='uiFont blackWhite printVar' value={v.voiceURI}>{v.name}</IonSelectOption>)\n                }\n              </IonSelect>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. * /}\n              <IonIcon icon={musicalNotes} slot='start' />\n              <div className=\"contentBlock\">\n                <div style={{ flexDirection: \"column\" }}>\n                  <IonLabel className='ion-text-wrap uiFont'><a href=\"https://github.com/MrMYHuang/twdi#text2speech\" target=\"_new\">合成語音語速</a>: {this.props.speechRate}</IonLabel>\n                  <IonRange min={0.1} max={1.5} step={0.1} snaps={true} value={this.props.speechRate} onIonChange={e => {\n                    this.props.dispatch({\n                      type: \"SET_KEY_VAL\",\n                      key: 'speechRate',\n                      val: (e.detail.value as number).toFixed(1),\n                    });\n                  }} />\n                </div>\n              </div>\n            </IonItem>\n          */}\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={helpCircle} slot='start' />\n              <div style={{ fontSize: 'var(--ui-font-size)' }}>\n                <div>關於</div>\n                <div><a href=\"https://github.com/MrMYHuang/twdi\" target=\"_new\">操作說明與開放原始碼</a></div>\n                <div>作者: Meng-Yuan Huang</div>\n                <div><a href=\"mailto:myh@live.com\" target=\"_new\">myh@live.com</a></div>\n              </div>\n            </IonItem>\n          </IonList>\n\n          <IonToast\n            cssClass='uiFont'\n            isOpen={this.state.showToast}\n            onDidDismiss={() => this.setState({ showToast: false })}\n            message={this.state.toastMessage}\n            duration={2000}\n          />\n        </IonContent>\n      </IonPage >\n    );\n  }\n};\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    settings: state.settings,\n    hasAppLog: state.settings.hasAppLog,\n    theme: state.settings.theme,\n    uiFontSize: state.settings.uiFontSize,\n    speechRate: state.settings.speechRate,\n    bookmarks: state.settings.bookmarks,\n    voiceURI: state.settings.voiceURI,\n    mainVersion: state.tmpSettings.mainVersion,\n  }\n};\n\nconst SettingsPage = withIonLifeCycle(_SettingsPage);\n\nexport default connect(\n  mapStateToProps,\n)(SettingsPage);\n","import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonList, IonReorderGroup, IonReorder, IonItem, IonLabel, withIonLifeCycle, IonItemSliding, IonItemOptions, IonItemOption, IonIcon, IonButton, IonToast } from '@ionic/react';\nimport { ItemReorderEventDetail } from '@ionic/core';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { Bookmark } from '../models/Bookmark';\nimport { swapVertical } from 'ionicons/icons';\nimport queryString from 'query-string';\nimport Globals from '../Globals';\n\ninterface Props {\n  dispatch: Function;\n  bookmarks: [Bookmark];\n  fontSize: number;\n}\n\ninterface State {\n  reorder: boolean;\n  showToast: boolean;\n  toastMessage: string;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\nconst helpDoc = Globals.isStoreApps() ?\n  <></>\n  :\n  <>\n    <div style={{ fontSize: 'var(--ui-font-size)', textAlign: 'center' }}><a href=\"https://github.com/MrMYHuang/twdi#web-app\" target=\"_new\">程式安裝說明</a></div>\n    <div style={{ fontSize: 'var(--ui-font-size)', textAlign: 'center' }}><a href=\"https://github.com/MrMYHuang/twdi#shortcuts\" target=\"_new\">程式捷徑</a></div>\n  </>\n  ;\n\nclass _BookmarkPage extends React.Component<PageProps, State> {\n  bookmarkListRef: React.RefObject<HTMLIonListElement>;\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      reorder: false,\n      showToast: false,\n      toastMessage: '',\n    }\n    this.bookmarkListRef = React.createRef<HTMLIonListElement>();\n  }\n\n  ionViewWillEnter() {\n    let queryParams = queryString.parse(this.props.location.search) as any;\n    if (queryParams.item && queryParams.item < this.props.bookmarks.length) {\n      const bookmark = this.props.bookmarks[queryParams.item];\n      this.props.history.push(`${Globals.pwaUrl}/dictionary/${bookmark.isChineseHerb ? 'chineseHerb' : 'drug'}/${bookmark.uuid}`);\n    } else if (!this.hasBookmark) {\n      this.setState({ showToast: true, toastMessage: '無書籤！請搜尋藥品並加至書籤。' });\n      this.props.history.push(`${Globals.pwaUrl}/dictionary/search`);\n    }\n    //console.log( 'view will enter' );\n  }\n\n  get hasBookmark() {\n    return this.props.bookmarks.length > 0;\n  }\n\n  delBookmarkHandler(uuidStr: string) {\n    this.props.dispatch({\n      type: \"DEL_BOOKMARK\",\n      uuid: uuidStr,\n    });\n\n    if (!this.hasBookmark) {\n      this.setState({ showToast: true, toastMessage: '無書籤！請搜尋藥品並加至書籤。' });\n      this.props.history.push(`${Globals.pwaUrl}/dictionary/search`);\n    }\n  }\n\n  reorderBookmarks(event: CustomEvent<ItemReorderEventDetail>) {\n    const bookmarks = event.detail.complete(this.props.bookmarks);\n    this.props.dispatch({\n      type: \"UPDATE_BOOKMARKS\",\n      bookmarks: bookmarks,\n    });\n  }\n\n  getBookmarkRows() {\n    let bookmarks = this.props.bookmarks;\n    let rows = Array<object>();\n    bookmarks.forEach((bookmark, i) => {\n      let routeLink = ``;\n      let label = `${bookmark.中文品名}`;\n      routeLink = `${Globals.pwaUrl}/dictionary/${bookmark.isChineseHerb ? 'chineseHerb' : 'drug'}/${bookmark.uuid}`;\n      rows.push(\n        <IonItemSliding key={`bookmarkItemSliding_` + i}>\n          <IonItem key={`bookmarkItem_` + i} button={true} onClick={async event => {\n            if (this.state.reorder) {\n              this.setState({ showToast: true, toastMessage: '請先關閉排列功能，才可點擊書籤！' });\n              return;\n            }\n\n            event.preventDefault();\n            this.props.history.push({\n              pathname: routeLink,\n            });\n          }}>\n            <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n            <IonLabel className='ion-text-wrap uiFont' key={`bookmarkItemLabel_` + i}>\n              {label}\n            </IonLabel>\n            <IonReorder slot='end' />\n          </IonItem>\n\n          <IonItemOptions side=\"end\">\n            <IonItemOption style={{ fontSize: 'var(--ui-font-size)' }} color='danger' onClick={(e) => {\n              this.delBookmarkHandler(bookmark.uuid);\n              this.bookmarkListRef.current?.closeSlidingItems();\n            }}>刪除</IonItemOption>\n          </IonItemOptions>\n        </IonItemSliding>\n      );\n    });\n    return rows;\n  }\n\n  render() {\n    const rows = this.getBookmarkRows();\n\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonTitle style={{ fontSize: 'var(--ui-font-size)' }}>書籤</IonTitle>\n\n            <IonButton fill={this.state.reorder ? 'solid' : 'clear'} slot='end'\n              onClick={ev => this.setState({ reorder: !this.state.reorder })}>\n              <IonIcon icon={swapVertical} slot='icon-only' />\n            </IonButton>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          {this.hasBookmark ?\n            <>\n              <IonList key='bookmarkList0' ref={this.bookmarkListRef}>\n                <IonReorderGroup disabled={!this.state.reorder} onIonItemReorder={(event: CustomEvent<ItemReorderEventDetail>) => { this.reorderBookmarks(event); }}>\n                  {rows}\n                </IonReorderGroup>\n              </IonList>\n              {helpDoc}\n            </> :\n            <>\n              <IonList key='bookmarkList1'>\n                {rows}\n              </IonList>\n              {helpDoc}\n            </>\n          }\n\n          <IonToast\n            cssClass='uiFont'\n            isOpen={this.state.showToast}\n            onDidDismiss={() => this.setState({ showToast: false })}\n            message={this.state.toastMessage}\n            duration={2000}\n          />\n        </IonContent>\n      </IonPage>\n    );\n  }\n};\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    bookmarks: state.settings.bookmarks,\n  }\n};\n\n//const mapDispatchToProps = {};\n\nconst BookmarkPage = withIonLifeCycle(_BookmarkPage);\n\nexport default connect(\n  mapStateToProps,\n)(BookmarkPage);\n","import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonToolbar, withIonLifeCycle, IonButton, IonIcon, IonSearchbar, IonAlert, IonList, IonItem, IonLabel, IonLoading, IonToast, IonTitle, IonInfiniteScroll, IonInfiniteScrollContent } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport Globals from '../Globals';\nimport { shareSocial, arrowBack } from 'ionicons/icons';\nimport { DictItem } from '../models/DictItem';\nimport { ChineseHerbItem } from '../models/ChineseHerbItem';\n\ninterface Props {\n  dispatch: Function;\n  loadingTwdData: boolean;\n  dictionaryHistory: Array<string>;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  path: string;\n  tab: string;\n  mode: string;\n  keyword: string;\n}> { }\n\ninterface State {\n  keyword: string;\n  searches: Array<DictItem | ChineseHerbItem>;\n  showNoSelectedTextAlert: boolean;\n  popover: any;\n  isScrollOn: boolean;\n  fetchError: boolean;\n  showToast: boolean;\n  toastMessage: string;\n}\n\nclass _DictionaryPage extends React.Component<PageProps, State> {\n  searchBarRef: React.RefObject<HTMLIonSearchbarElement>;\n  filteredData: Array<DictItem | ChineseHerbItem>;\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      keyword: '',\n      searches: [],\n      showNoSelectedTextAlert: false,\n      popover: {\n        show: false,\n        event: null,\n      },\n      isScrollOn: false,\n      fetchError: false,\n      showToast: false,\n      toastMessage: '',\n    }\n    this.searchBarRef = React.createRef<HTMLIonSearchbarElement>();\n    this.filteredData = [];\n  }\n\n  mode = '';\n  ionViewWillEnter() {\n    //console.log(`${this.props.match.url} will enter`);\n    this.mode = this.props.match.params.mode;\n    const keyword = this.props.match.params.keyword;\n    this.setState({ keyword: keyword });\n    this.search(true);\n  }\n\n  /*\n  componentDidMount() {\n    //console.log(`did mount: ${this.props.match.url}`);\n  }\n  \n  componentWillUnmount() {\n    console.log(`${this.props.match.url} unmount`);\n  }\n\n  ionViewWillLeave() {\n  }\n  */\n\n  get isTopPage() {\n    return this.props.match.params.keyword === undefined;\n  }\n\n  page = 0;\n  rows = 20;\n  async search(newSearch: boolean = false) {\n    await new Promise<void>((ok, fail) => {\n      let timer = setInterval(() => {\n        if (!this.props.loadingTwdData) {\n          clearInterval(timer);\n          ok();\n        }\n      }, 50);\n    });\n\n    if (this.props.match.params.keyword == null || this.props.match.params.keyword !== this.state.keyword) {\n      return;\n    }\n\n    if (newSearch) {\n      const re = new RegExp(`.*${this.props.match.params.keyword}.*`, 'i');\n      if (this.mode !== 'searchCH') {\n        this.filteredData = Globals.dictItems.filter((dictItem) =>\n          dictItem.通關簽審文件編號 !== \"null\" && (re.test(dictItem.中文品名) || re.test(dictItem.英文品名) || re.test(dictItem.通關簽審文件編號) || re.test(dictItem.製造商名稱) || re.test(dictItem.主成分略述))\n        );\n      } else {\n        this.filteredData = Globals.chineseHerbsItems.filter((dictItem) =>\n          (re.test(dictItem.藥品名稱) || re.test(dictItem.處方成分) || re.test(dictItem.許可證字號) || re.test(dictItem.製造商名稱))\n        );\n      }\n      this.page = 0;\n    }\n\n    console.log(`Loading page ${this.page}`);\n\n    const searches = this.filteredData.slice(this.page * this.rows, (this.page + 1) * this.rows);\n\n    this.page += 1;\n    this.setState({\n      fetchError: false, searches: newSearch ? searches : [...this.state.searches, ...searches],\n      isScrollOn: this.state.searches.length < this.filteredData.length,\n    });\n\n    if (newSearch) {\n      this.props.dictionaryHistory.unshift(this.state.keyword);\n      this.props.dictionaryHistory.splice(10);\n      this.props.dispatch({\n        type: \"SET_KEY_VAL\",\n        key: 'dictionaryHistory',\n        val: this.props.dictionaryHistory,\n      });\n    }\n    return true;\n  }\n\n  getRows() {\n    const data = this.state.searches;\n    let rows = Array<object>();\n    data.forEach((item: DictItem | ChineseHerbItem, index: number) => {\n      const drugId = this.mode !== 'searchCH' ? (item as DictItem).通關簽審文件編號 : /[^\\d]*(\\d*)/.exec((item as ChineseHerbItem).許可證字號)![1];\n      rows.push(\n        <IonItem button={true} key={`dictItem` + index}\n          onClick={async event => {\n            event.preventDefault();\n            this.props.history.push({\n              pathname: `${Globals.pwaUrl}/dictionary/${this.mode === 'searchCH' ? 'chineseHerb' : 'drug'}/${drugId}`,\n            });\n          }}>\n          <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n          <IonLabel className='ion-text-wrap uiFont' key={`bookmarkItemLabel_` + index}>\n            {this.mode !== 'searchCH' ? (item as DictItem).中文品名 : (item as ChineseHerbItem).藥品名稱}\n          </IonLabel>\n        </IonItem>\n      );\n    });\n    return rows;\n  }\n\n  render() {\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonButton hidden={this.isTopPage} fill=\"clear\" slot='start' onClick={e => this.props.history.goBack()}>\n              <IonIcon icon={arrowBack} slot='icon-only' />\n            </IonButton>\n\n            <IonTitle style={{ fontSize: 'var(--ui-font-size)' }}>搜尋藥品</IonTitle>\n\n            <IonButton fill='outline' shape='round' slot='start' onClick={ev => {\n              this.props.history.push({\n                pathname: `${Globals.pwaUrl}/dictionary/${this.mode === 'searchCH' ? 'search' : 'searchCH'}`,\n              });\n            }}>\n              <span className='uiFont'>{this.mode !== 'searchCH' ? '西藥' : '中藥'}</span>\n            </IonButton>\n\n            <IonButton fill=\"clear\" slot='end' onClick={e => {\n              this.props.dispatch({\n                type: \"TMP_SET_KEY_VAL\",\n                key: 'shareTextModal',\n                val: {\n                  show: true,\n                  text: decodeURIComponent(window.location.href),\n                },\n              });\n            }}>\n              <IonIcon icon={shareSocial} slot='icon-only' />\n            </IonButton>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          <IonSearchbar ref={this.searchBarRef} placeholder='按Enter鍵搜尋' value={this.state.keyword}\n            onIonClear={ev => {\n              this.props.history.push({\n                pathname: `${Globals.pwaUrl}/dictionary/${this.mode}`,\n              });\n            }}\n            onKeyUp={(ev: any) => {\n              const value = ev.target.value;\n              this.setState({ keyword: value })\n              if (value === '') {\n              } else if (ev.key === 'Enter') {\n                if (value === this.props.match.params.keyword) {\n                  this.search(true);\n                } else {\n                  this.props.history.push({\n                    pathname: `${Globals.pwaUrl}/dictionary/${this.mode}/${value}`,\n                  });\n                }\n              }\n            }}\n          />\n\n          {this.props.loadingTwdData ?\n            <IonLoading\n              cssClass='uiFont'\n              isOpen={this.props.loadingTwdData}\n              message={'載入中...'}\n            />\n            :\n            this.props.match.params.keyword == null || this.state.searches.length < 1 || (this.props.dictionaryHistory.length > 0 && (this.state.keyword === '' || this.state.keyword === undefined)) ?\n              <>\n                <div className='uiFont' style={{ color: 'var(--ion-color-primary)' }}>搜尋歷史</div>\n                <IonList>\n                  {this.props.dictionaryHistory.map((keyword, i) =>\n                    <IonItem key={`dictHistoryItem_${i}`} button={true} onClick={async event => {\n                      if (keyword === this.props.match.params.keyword) {\n//                        this.setState({ keyword });\n//                        this.search(true);\n                      }\n                      else {\n                        this.props.history.push({\n                          pathname: `${Globals.pwaUrl}/dictionary/${this.mode}/${keyword}`,\n                        });\n                      }\n                    }}>\n                      <IonLabel className='ion-text-wrap uiFont' key={`dictHistoryLabel_` + i}>\n                        {keyword}\n                      </IonLabel>\n                    </IonItem>\n                  )}\n                </IonList>\n                <div style={{ textAlign: 'center' }}>\n                  <IonButton fill='outline' shape='round' size='large' onClick={e => {\n                    this.setState({ keyword: '' });\n                    this.props.dispatch({\n                      type: \"SET_KEY_VAL\",\n                      key: 'dictionaryHistory',\n                      val: [],\n                    });\n                  }}>清除歷史</IonButton>\n                </div>\n              </>\n              :\n                <IonList>\n                  {this.getRows()}\n                  <IonInfiniteScroll threshold=\"100px\"\n                    disabled={!this.state.isScrollOn}\n                    onIonInfinite={(ev: CustomEvent<void>) => {\n                      this.search();\n                      (ev.target as HTMLIonInfiniteScrollElement).complete();\n                    }}>\n                    <IonInfiniteScrollContent\n                      loadingText=\"載入中...\">\n                    </IonInfiniteScrollContent>\n                  </IonInfiniteScroll>\n                </IonList>\n          }\n\n          <IonAlert\n            cssClass='uiFont'\n            isOpen={this.state.showNoSelectedTextAlert}\n            backdropDismiss={false}\n            header='失敗'\n            message='請確認是否已選擇一段文字，然後再執行所選的功能!'\n            buttons={[\n              {\n                text: '確定',\n                cssClass: 'primary uiFont',\n                handler: (value) => {\n                  this.setState({\n                    showNoSelectedTextAlert: false,\n                  });\n                },\n              }\n            ]}\n          />\n\n          <IonToast\n            cssClass='uiFont'\n            isOpen={this.state.showToast}\n            onDidDismiss={() => this.setState({ showToast: false })}\n            message={this.state.toastMessage}\n            duration={2000}\n          />\n        </IonContent>\n      </IonPage>\n    );\n  }\n};\n\nconst DictionaryPage = withIonLifeCycle(_DictionaryPage);\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    loadingTwdData: state.tmpSettings.loadingTwdData,\n    dictionaryHistory: state.settings.dictionaryHistory,\n  }\n};\n\n//const mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n)(DictionaryPage);\n","import React from 'react';\nimport { IonButton, IonContent, IonItem, IonLabel, IonList, IonModal, IonToggle } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport Globals from '../Globals';\nimport * as qrcode from 'qrcode';\n\ninterface Props {\n  showModal: boolean;\n  text: string;\n  finish: Function;\n  settings: any;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface State {\n  isAppSettingsExport: Array<boolean>;\n}\n\nclass _ShareTextModal extends React.Component<PageProps, State> {\n\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      isAppSettingsExport: Array<boolean>(Object.keys(Globals.appSettings).length)\n    }\n  }\n\n  updateQrCode() {\n    const appSettingsExport = Object.keys(Globals.appSettings).filter((key, i) => this.state.isAppSettingsExport[i]).map((key, i) => {return {key: key, val: this.props.settings[key]};});\n    let appSettingsString: string | null = appSettingsExport.map(keyVal => `${keyVal.key}=${+keyVal.val}`).join(',');\n    appSettingsString = appSettingsString !== '' ? `settings=${appSettingsString}` : null;\n    let appUrl = this.props.text;\n    const hasQueryString = /\\?/.test(appUrl);\n    if (appSettingsString) {\n      appUrl += hasQueryString ? `&${appSettingsString}` : `?${appSettingsString}`;\n    }\n    \n    Globals.copyToClipboard(appUrl);\n    const qrcCanvas = document.getElementById('qrcCanvas');\n    qrcode.toCanvas(qrcCanvas, appUrl);\n    return qrcCanvas;\n  }\n\n  render() {\n    return (\n      <IonModal\n        isOpen={this.props.showModal}\n        cssClass='uiFont'\n        swipeToClose={true}\n        //presentingElement={router || undefined}\n        onWillPresent={() => {\n          let isAppSettingsExport: Array<boolean> = [];\n          for (let i = 0; i < this.state.isAppSettingsExport.length; i++) {\n            isAppSettingsExport.push(false);\n          }\n          this.setState({isAppSettingsExport: isAppSettingsExport});\n          this.updateQrCode();\n        }}\n        onDidDismiss={() => this.props.finish()}>\n        <IonContent>\n          <div style={{ display: 'flex', flexDirection: 'column', height: '100%', alignItems: 'center' }}>\n            <div>\n              <IonLabel className='uiFont'>此頁app連結已複製至剪貼簿！</IonLabel>\n            </div>\n            <div>\n              <IonLabel className='uiFont'>也可以使用QR Code分享:</IonLabel>\n            </div>\n            <div style={{ flexGrow: 1, flexShrink: 0, display: 'flex', alignItems: 'center', margin: 10 }}>\n              <canvas id='qrcCanvas' width='500' height='500' style={{ margin: '0px auto' }} />\n            </div>\n            <div>\n              <IonLabel className='uiFont'>包括app設定:</IonLabel>\n              <IonList>\n                {\n                  Object.keys(Globals.appSettings).map((key, i) =>\n                    <IonItem key={`appSettingExportItem_${i}`}>\n                      <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings[key]}</IonLabel>\n                      <IonToggle slot='end' onIonChange={e => {\n                        const isAppSettingsExport =  this.state.isAppSettingsExport;\n                        isAppSettingsExport[i] = e.detail.checked;\n                        this.setState({isAppSettingsExport: isAppSettingsExport});\n                        this.updateQrCode();\n                      }} />\n                    </IonItem>\n                  )\n                }\n              </IonList>\n            </div>\n            <div>\n              <IonButton fill='outline' shape='round' size='large' onClick={() => this.props.finish()}>關閉</IonButton>\n            </div>\n          </div>\n        </IonContent>\n      </IonModal>\n    );\n  }\n};\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    settings: state.settings,\n  }\n};\n\n//const mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n)(_ShareTextModal);\n","import React from 'react';\nimport { IonContent, IonLabel, IonModal, IonProgressBar } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\n\ninterface Props {\n  item: string;\n  showModal: boolean;\n  progress: number;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n}> { }\n\ninterface State {\n}\n\nclass _DownloadModal extends React.Component<PageProps, State> {\n\n  constructor(props: any) {\n    super(props);\n    this.state = {\n    }\n  }\n\n  render() {\n    return (\n      <IonModal\n        isOpen={this.props.showModal}\n        cssClass='uiFont'\n        backdropDismiss={false}\n        swipeToClose={false}\n      >\n        <IonContent>\n          <div style={{ display: 'flex', flexDirection: 'column', height: '100%', alignItems: 'center' }}>\n              <IonLabel className='uiFont'>{this.props.item}下載中，請等待。</IonLabel>\n              <IonProgressBar style={{ height: '40px' }} value={this.props.progress / 100} />\n              <IonLabel className='uiFont'>{Math.floor(this.props.progress)}%</IonLabel>\n          </div>\n        </IonContent>\n      </IonModal>\n    );\n  }\n};\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n  }\n};\n\n//const mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n)(_DownloadModal);\n","export class Bookmark {\n    uuid: string = '';\n    中文品名: string = '';\n    isChineseHerb: boolean = false;\n\n    constructor(json: Bookmark) {\n        this.uuid = json.uuid;\n        this.中文品名 = json.中文品名;\n        this.isChineseHerb = json.isChineseHerb;\n    }\n}\n","export class DictItem {\n    通關簽審文件編號: string;\n    中文品名: string;\n    英文品名: string;\n    適應症: string;\n    劑型: string;\n    管制藥品分類級別: string;\n    用法用量: string;\n    包裝: string;\n    包裝與國際條碼: string;\n    有效日期: string;\n    發證日期: string;\n    許可證字號: string;\n    許可證種類: string;\n    舊證字號: string;\n    藥品類別: string;\n    主成分略述: string;\n    異動日期: string;\n\n    申請商名稱: string;\n    申請商地址: string;\n    申請商統一編號: string;\n    製造商名稱: string;\n    製造廠國別: string;\n    製造廠廠址: string;\n    製造廠公司地址: string;\n\n    製程: string;\n    註銷狀態: string;\n    註銷日期: string;\n    註銷理由: string;\n\n    constructor(json: any) {\n        this.製造廠廠址 = json.製造廠廠址;\n        this.許可證種類 = json.許可證種類;\n        this.許可證字號 = json.許可證字號;\n        this.註銷理由 = json.註銷理由;\n        this.劑型 = json.劑型;\n        this.通關簽審文件編號 = json.通關簽審文件編號;\n        this.舊證字號 = json.舊證字號;\n        this.發證日期 = json.發證日期;\n        this.異動日期 = json.異動日期;\n        this.製造商名稱 = json.製造商名稱;\n        this.主成分略述 = json.主成分略述;\n        this.管制藥品分類級別 = json.管制藥品分類級別;\n        this.有效日期 = json.有效日期;\n        this.製造廠國別 = json.製造廠國別;\n        this.註銷狀態 = json.註銷狀態;\n        this.藥品類別 = json.藥品類別;\n        this.適應症 = json.適應症;\n        this.製造廠公司地址 = json.製造廠公司地址;\n        this.英文品名 = json.英文品名;\n        this.包裝與國際條碼 = json.包裝與國際條碼;\n        this.申請商地址 = json.申請商地址;\n        this.包裝 = json.包裝;\n        this.申請商統一編號 = json.申請商統一編號;\n        this.中文品名 = json.中文品名;\n        this.用法用量 = json.用法用量;\n        this.申請商名稱 = json.申請商名稱;\n        this.製程 = json.製程;\n        this.註銷日期 = json.註銷日期;\n    }\n\n    static sortedKeys = [\n        \"中文品名\",\n        \"英文品名\",\n        \"通關簽審文件編號\",\n        \"適應症\",\n        \"用法用量\",\n        \"主成分略述\",\n        \"劑型\",\n        \"包裝\",\n        \"包裝與國際條碼\",\n        \"藥品類別\",\n        \"管制藥品分類級別\",\n        \"許可證字號\",\n        \"許可證種類\",\n        \"發證日期\",\n        \"有效日期\",\n        \"異動日期\",\n        \"舊證字號\",\n        \"製程\",\n        \"註銷狀態\",\n        \"註銷日期\",\n        \"註銷理由\",\n\n        \"申請商名稱\",\n        \"申請商地址\",\n        \"申請商統一編號\",\n        \"製造商名稱\",\n        \"製造廠國別\",\n        \"製造廠廠址\",\n        \"製造廠公司地址\",\n    ];\n}\n","export class ChineseHerbItem {\n    許可證字號: string\n    限制項目: string\n    藥品名稱: string\n    劑型與類別: string\n    適應症及效能: string\n    處方成分: string\n    \"單/複方\": string\n    包裝: string\n    藥商名稱: string\n    製造商名稱: string\n    製造商地址: string\n    發證日期: string\n    有效日期: string\n\n    constructor(json: any) {\n        this.許可證字號 = json.許可證字號;\n        this.限制項目 = json.限制項目;\n        this.藥品名稱 = json.藥品名稱;\n        this.劑型與類別 = json.劑型與類別;\n        this.適應症及效能 = json.適應症及效能;\n        this.處方成分 = json.處方成分;\n        this[\"單/複方\"] = json.單複方;\n        this.包裝 = json.包裝;\n        this.藥商名稱 = json.藥商名稱;\n        this.製造商名稱 = json.製造商名稱;\n        this.製造商地址 = json.製造商地址;\n        this.發證日期 = json.發證日期;\n        this.有效日期 = json.有效日期;\n    }\n\n    static sortedKeys = [\n        \"藥品名稱\",\n        \"適應症及效能\",\n        \"限制項目\",\n        \"處方成分\",\n        \"單/複方\",\n        \"劑型與類別\",\n        \"包裝\",\n        \"藥商名稱\",\n        \"製造商名稱\",\n        \"製造商地址\",\n        \"許可證字號\",\n        \"發證日期\",\n        \"有效日期\",\n    ];\n}\n","import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonToolbar, withIonLifeCycle, IonButton, IonIcon, IonList, IonItem, IonLabel, IonLoading, IonToast, IonTitle } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport Globals from '../Globals';\nimport { shareSocial, arrowBack, bookmark } from 'ionicons/icons';\nimport { Bookmark } from '../models/Bookmark';\nimport { DictItem } from '../models/DictItem';\nimport { ChineseHerbItem } from '../models/ChineseHerbItem';\n\ninterface Props {\n  dispatch: Function;\n  loadingTwdData: boolean;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  path: string;\n  tab: string;\n  mode: string;\n  keyword: string;\n}> { }\n\ninterface State {\n  keyword: string;\n  search: DictItem | ChineseHerbItem | null;\n  showNoSelectedTextAlert: boolean;\n  popover: any;\n  showToast: boolean;\n  toastMessage: string;\n}\n\nclass _DrugPage extends React.Component<PageProps, State> {\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      keyword: '',\n      search: null,\n      showNoSelectedTextAlert: false,\n      popover: {\n        show: false,\n        event: null,\n      },\n      showToast: false,\n      toastMessage: '',\n    }\n  }\n\n  mode = '';\n  ionViewWillEnter() {\n    //console.log( 'view will enter' );\n    //console.log(this.props.match.url);\n    //console.log(this.props.history.length);\n    this.mode = this.props.match.params.mode;\n    if (this.props.match.params.keyword) {\n      this.setState({ keyword: this.props.match.params.keyword });\n    }\n    this.lookupDict(this.props.match.params.keyword);\n  }\n\n  componentDidMount() {\n    //console.log(`did mount: ${this.props.match.url}`);\n  }\n\n  ionViewWillLeave() {\n  }\n\n  get isTopPage() {\n    return this.props.match.url === `/${this.props.match.params.tab}`;\n  }\n\n  async lookupDict(keyword: string) {\n    await new Promise<void>((ok, fail) => {\n      let timer = setInterval(() => {\n        if (!this.props.loadingTwdData) {\n          clearInterval(timer);\n          ok();\n    }\n      }, 50);\n    });\n\n    const chineseHerbIdPattern = new RegExp(`.*${keyword}`)\n    const res = (this.mode !== 'chineseHerb' ? Globals.dictItems.find((dictItem) => dictItem.通關簽審文件編號 === keyword) : Globals.chineseHerbsItems.find((dictItem) => chineseHerbIdPattern.test(dictItem.許可證字號))) || null;\n    this.setState({ search: res });\n  }\n\n  addBookmarkHandler() {\n    const search = this.state.search!;\n    const drugId = this.mode !== 'chineseHerb' ? (search as DictItem).通關簽審文件編號 : (search as ChineseHerbItem).許可證字號;\n    const name = this.mode !== 'chineseHerb' ? (search as DictItem).中文品名 : (search as ChineseHerbItem).藥品名稱;\n    this.props.dispatch({\n      type: \"ADD_BOOKMARK\",\n      bookmark: new Bookmark({\n        uuid: drugId,\n        中文品名: name,\n        isChineseHerb: this.mode === 'chineseHerb'\n      }),\n    });\n    this.setState({ showToast: true, toastMessage: '書籤新增成功！' });\n    return;\n  }\n\n  render() {\n    let dictView: any = [];\n    if (this.props.match.params.keyword && this.state.search != null) {\n      const search = this.state.search!;\n      (this.mode !== 'chineseHerb' ? DictItem : ChineseHerbItem).sortedKeys.forEach((key, index) => {\n        const value = (search as any)[key];\n        dictView.push(\n          <IonItem button={true} key={`contentItem` + index}\n            onClick={async event => {\n              event.preventDefault();\n              Globals.copyToClipboard(value);\n              this.setState({ showToast: true, toastMessage: `複製\"${key}\"成功` })\n            }}>\n            <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n            <IonLabel className='ion-text-wrap textFont' key={`contentItemlabel_` + index}>\n              {key}: {value}\n            </IonLabel>\n          </IonItem>\n        )\n      });\n    }\n\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonButton fill=\"clear\" slot='start' onClick={e => this.props.history.goBack()}>\n              <IonIcon icon={arrowBack} slot='icon-only' />\n            </IonButton>\n\n            <IonTitle style={{ fontSize: 'var(--ui-font-size)' }}>藥品資料</IonTitle>\n\n            <IonButton fill=\"clear\" slot='end' onClick={e => {\n              this.props.dispatch({\n                type: \"TMP_SET_KEY_VAL\",\n                key: 'shareTextModal',\n                val: {\n                  show: true,\n                  text: decodeURIComponent(window.location.href),\n                },\n              });\n            }}>\n              <IonIcon icon={shareSocial} slot='icon-only' />\n            </IonButton>\n\n            <IonButton hidden={this.props.loadingTwdData} fill=\"clear\" slot='end' onClick={e => {\n              this.setState({ popover: { show: false, event: null } });\n              this.addBookmarkHandler();\n            }}>\n              <IonIcon icon={bookmark} slot='icon-only' />\n            </IonButton>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n\n          <IonLoading\n            cssClass='uiFont'\n            isOpen={this.props.loadingTwdData}\n            message={'載入中...'}\n          />\n\n          <IonList key='contentList1'>\n            {dictView}\n          </IonList>\n\n          <IonToast\n            cssClass='uiFont'\n            isOpen={this.state.showToast}\n            onDidDismiss={() => this.setState({ showToast: false })}\n            message={this.state.toastMessage}\n            duration={2000}\n          />\n        </IonContent>\n      </IonPage>\n    );\n  }\n};\n\nconst DrugPage = withIonLifeCycle(_DrugPage);\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    loadingTwdData: state.tmpSettings.loadingTwdData,\n  };\n};\n\n\n//const mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n)(DrugPage);\n","import React from 'react';\nimport { Redirect, Route, RouteComponentProps, withRouter } from 'react-router-dom';\nimport {\n  setupConfig,\n  IonApp,\n  IonIcon,\n  IonRouterOutlet,\n  IonTabBar,\n  IonTabButton,\n  IonTabs,\n  IonAlert,\n  IonToast,\n} from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\nimport { connect, Provider } from 'react-redux';\nimport queryString from 'query-string';\nimport getSavedStore from './redux/store';\nimport { bookmark, settings, search } from 'ionicons/icons';\n\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\nimport SettingsPage from './pages/SettingsPage';\nimport BookmarkPage from './pages/BookmarkPage';\nimport Globals from './Globals';\nimport DictionaryPage from './pages/DictionaryPage';\nimport ShareTextModal from './components/ShareTextModal';\nimport DownloadModal from './components/DownloadModal';\nimport DrugPage from './pages/DrugPage';\n\nconst electronBackendApi: any = (window as any).electronBackendApi;\n\nlet store = getSavedStore();\n/*\nclass DebugRouter extends IonReactRouter {\n  constructor(props: any) {\n    super(props);\n    console.log('initial history is: ', JSON.stringify(this.history, null, 2))\n    this.history.listen((location, action) => {\n      console.log(\n        `The current URL is ${location.pathname}${location.search}${location.hash}`\n      )\n      console.log(`The last navigation action was ${action}`, JSON.stringify(this.history, null, 2));\n    });\n  }\n}\n*/\n\nsetupConfig({\n  mode: 'md', // Use a consistent UI style across Android and iOS.\n  swipeBackEnabled: false,\n});\n\nexport var serviceWorkCallbacks = {\n  onSuccess: function (registration: ServiceWorkerRegistration) { },\n  onUpdate: function (registration: ServiceWorkerRegistration) { },\n};\n\ninterface Props {\n  dispatch: Function;\n  shareTextModal: any;\n  settings: any;\n}\n\ninterface PageProps extends RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface AppOrigProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface State {\n  showToast: boolean;\n  toastMessage: string;\n  showUpdateAlert: boolean;\n  showDataDownloadEndAlert: boolean;\n  showRestoreAppSettingsToast: boolean;\n  downloadModal: any;\n}\n\nclass _App extends React.Component<PageProps> {\n  render() {\n    return (\n      <Provider store={store}>\n        <AppOrig {...this.props} />\n      </Provider>\n    );\n  }\n}\n\nclass _AppOrig extends React.Component<AppOrigProps, State> {\n  registrationNew: ServiceWorkerRegistration | null;\n  originalAppSettingsStr: string | null | undefined;\n\n  constructor(props: any) {\n    super(props);\n    if (!this.props.settings.hasAppLog) {\n      Globals.disableAppLog();\n    }\n\n    electronBackendApi?.receive(\"fromMain\", (data: any) => {\n      switch (data.event) {\n        case 'version':\n          store.dispatch({\n            type: \"TMP_SET_KEY_VAL\",\n            key: 'mainVersion',\n            val: data.version,\n          });\n          break;\n      }\n    });\n    electronBackendApi?.send(\"toMain\", { event: 'ready' });\n\n    this.registrationNew = null;\n\n    // ----- Initializing UI settings -----\n    // Apply the theme setting.\n    while (document.body.classList.length > 0) {\n      document.body.classList.remove(document.body.classList.item(0)!);\n    }\n    document.body.classList.toggle(`theme${this.props.settings.theme}`, true);\n\n    // Modify UI settings from query string.\n    const queryParams = queryString.parse(this.props.location.search) as any;\n    if (queryParams.settings) {\n      this.originalAppSettingsStr = localStorage.getItem(Globals.storeFile);\n      (queryParams.settings as string).split(',').forEach(setting => {\n        const keyVal = setting.split('=');\n        this.props.dispatch({\n          type: \"SET_KEY_VAL\",\n          key: keyVal[0],\n          val: +keyVal[1],\n        });\n      });\n    }\n    Globals.updateCssVars(this.props.settings);\n\n    this.state = {\n      showUpdateAlert: false,\n      showRestoreAppSettingsToast: (queryParams.settings != null && this.originalAppSettingsStr != null) || false,\n      showToast: false,\n      showDataDownloadEndAlert: false,\n      toastMessage: '',\n      downloadModal: { progress: 0, show: false }\n    };\n\n    serviceWorkCallbacks.onUpdate = (registration: ServiceWorkerRegistration) => {\n      this.registrationNew = registration;\n      this.setState({ showUpdateAlert: true });\n    };\n\n    serviceWorkCallbacks.onSuccess = (registration: ServiceWorkerRegistration) => {\n    };\n\n    // Preload speechSynthesis.\n    if (typeof speechSynthesis !== 'undefined') {\n      speechSynthesis.getVoices();\n      speechSynthesis.cancel();\n    }\n\n    // Enable screen wake lock.\n    if ((navigator as any).wakeLock) {\n      this.wakeLockScreen();\n      document.addEventListener(\"visibilitychange\", async () => {\n        if (document.visibilityState === 'visible') {\n          this.wakeLockScreen();\n        } else {\n          this.wakeLockScreenRelease()\n        }\n      });\n    }\n\n    const dbOpenReq = indexedDB.open(Globals.twdiDb);\n    // Init store in indexedDB if necessary.\n    dbOpenReq.onupgradeneeded = function (event: IDBVersionChangeEvent) {\n      var db = (event.target as any).result;\n      db.createObjectStore('store');\n      console.log(`DB store created.`);\n    };\n    this.loadTwdData();\n  }\n\n  restoreAppSettings() {\n    localStorage.setItem(Globals.storeFile, this.originalAppSettingsStr!);\n    this.props.dispatch({ type: 'LOAD_SETTINGS' });\n    while (document.body.classList.length > 0) {\n      document.body.classList.remove(document.body.classList.item(0)!);\n    }\n    document.body.classList.toggle(`theme${this.props.settings.theme}`, true);\n    Globals.updateCssVars(this.props.settings);\n  }\n\n  async loadTwdData() {\n    store.dispatch({\n      type: \"TMP_SET_KEY_VAL\",\n      key: 'loadingTwdData',\n      val: true,\n    });\n    let twdData: any;\n    for (let i = 0; i < Globals.durgResources.length; i++) {\n      let item = Globals.durgResources[i];\n      try {\n        twdData = await Globals.getFileFromIndexedDB(item.dataKey);\n      } catch (err) {\n        this.setState({ downloadModal: { item: item.item, show: true, progress: 0 } });\n        twdData = await Globals.downloadTwdData(item.url, (progress: number) => {\n          this.setState({ downloadModal: { item: item.item, show: true, progress: progress } });\n        });\n        this.setState({ downloadModal: { item: item.item, show: false, progress: 100 } });\n        Globals.saveFileToIndexedDB(item.dataKey, twdData);\n      }\n\n      if (i === 0) {\n        Globals.dictItems = twdData;\n      } else {\n        Globals.chineseHerbsItems = twdData;\n      }\n    }\n    store.dispatch({\n      type: \"TMP_SET_KEY_VAL\",\n      key: 'loadingTwdData',\n      val: false,\n    });\n  }\n\n  // Prevent device from sleeping.\n  wakeLock: any;\n  async wakeLockScreen() {\n    try {\n      const wakeLock = (navigator as any).wakeLock;\n      if (wakeLock != null) {\n        this.wakeLock = await wakeLock.request('screen');\n        console.log('Screen wake lock is requested.');\n      } else {\n        console.error('navigator.wakeLock is undefined.');\n      }\n    } catch (err: any) {\n      // the wake lock request fails - usually system related, such low as battery\n      console.log(`${err.name}, ${err.message}`);\n      console.log(new Error().stack);\n    }\n  }\n\n  async wakeLockScreenRelease() {\n    if (this.wakeLock != null) {\n      await this.wakeLock.release();\n      this.wakeLock = null;\n      console.log('Screen wake lock is released.');\n    }\n  }\n\n  routeByQueryString() {\n    // This app uses client side routing. \n    // Without the first loading of this app,\n    // any client side route becomes a server side route!\n    // These invalid server side routings cause 404 errors.\n    // To workaround these errors, we can use GitHub 404.html redirection\n    // to pass the client side routes to this app by using query string.\n    // After this app loads, it can use the query string to correctly redirect to\n    // a client side route!\n    console.log(window.location.search);\n    const routeMatches = /route=([^&]*)/.exec(window.location.search);\n    const queryMatches = /query=([^&]*)/.exec(window.location.search);\n    if (routeMatches !== null) {\n      const route = decodeURIComponent(routeMatches[1]);\n\n      let query = ''\n      if (queryMatches !== null) {\n        query = decodeURIComponent(queryMatches[1]);\n      }\n      return <Redirect to={route + query} />;\n    } else if (window.location.pathname === `${Globals.pwaUrl}/` || window.location.pathname === `${Globals.pwaUrl}`) {\n      return <Redirect to={`${Globals.pwaUrl}/bookmarks`} />;\n    }\n  }\n\n  render() {\n    return (\n      <IonApp>\n        <IonReactRouter>\n          <IonTabs>\n            <IonRouterOutlet animated={false}>\n              {/* The following route is for backward compatibility. */}\n              <Route path={`${Globals.pwaUrl}/:tab(bookmarks)`} render={(props: any) => <BookmarkPage {...props} />} exact={true} />\n              <Route path={`${Globals.pwaUrl}/:tab(dictionary)/:mode(search)/:keyword?`} render={(props: any) => <DictionaryPage {...props} />} exact={true} />\n              <Route path={`${Globals.pwaUrl}/:tab(dictionary)/:mode(searchCH)/:keyword?`} render={(props: any) => <DictionaryPage {...props} />} exact={true} />\n              <Route path={`${Globals.pwaUrl}/:tab(dictionary)/:mode(drug)/:keyword?`} render={(props: any) => <DrugPage {...props} />} exact={true} />\n              <Route path={`${Globals.pwaUrl}/:tab(dictionary)/:mode(chineseHerb)/:keyword?`} render={(props: any) => <DrugPage {...props} />} exact={true} />\n              <Route path={`${Globals.pwaUrl}/settings`} render={(props: any) => <SettingsPage {...props} />} />\n              <Route path={`${Globals.pwaUrl}/`} render={() => { return this.routeByQueryString(); }} exact={true} />\n            </IonRouterOutlet>\n            <IonTabBar slot=\"bottom\">\n              <IonTabButton tab=\"bookmarks\" href={`${Globals.pwaUrl}/bookmarks`}>\n                <IonIcon icon={bookmark} />\n              </IonTabButton>\n              <IonTabButton tab=\"dictionay\" href={`${Globals.pwaUrl}/dictionary/search`}>\n                <IonIcon icon={search} />\n              </IonTabButton>\n              <IonTabButton tab=\"settings\" href={`${Globals.pwaUrl}/settings`}>\n                <IonIcon icon={settings} />\n              </IonTabButton>\n            </IonTabBar>\n          </IonTabs>\n        </IonReactRouter>\n        <IonAlert\n          cssClass='uiFont'\n          isOpen={this.state.showUpdateAlert}\n          backdropDismiss={false}\n          onDidPresent={(ev) => {\n            // Run SKIP_WAITING at onDidPresent event to avoid a race condition of\n            // an old page fetching old JS chunks with a new service worker!\n            this.registrationNew?.installing?.postMessage({ type: 'SKIP_WAITING' });\n            this.registrationNew?.waiting?.postMessage({ type: 'SKIP_WAITING' });\n          }}\n          header={'App 已更新，請重啟!'}\n          buttons={[\n            {\n              text: '關閉',\n              cssClass: 'primary uiFont',\n              handler: (value) => {\n                this.setState({\n                  showUpdateAlert: false,\n                });\n              },\n            },\n          ]}\n        />\n\n        <ShareTextModal\n          {...{\n            text: this.props.shareTextModal?.text,\n            showModal: this.props.shareTextModal?.show || false,\n            finish: () => {\n              store.dispatch({\n                type: \"TMP_SET_KEY_VAL\",\n                key: 'shareTextModal',\n                val: { show: false },\n              });\n            }, ...this.props\n          }}\n        />\n\n        <DownloadModal\n          {...{\n            item: this.state.downloadModal.item,\n            progress: this.state.downloadModal.progress,\n            showModal: this.state.downloadModal.show,\n            ...this.props\n          }}\n        />\n\n        <IonAlert\n          cssClass='uiFont'\n          isOpen={this.state.showDataDownloadEndAlert}\n          backdropDismiss={false}\n          header={'藥品資料下載完成！'}\n          buttons={[\n            {\n              text: '關閉',\n              cssClass: 'primary uiFont',\n              handler: (value) => {\n                this.setState({\n                  showDataDownloadEndAlert: false,\n                });\n              },\n            },\n          ]}\n        />\n\n        <IonToast\n          cssClass='uiFont'\n          isOpen={this.state.showRestoreAppSettingsToast}\n          onDidDismiss={() => this.setState({ showRestoreAppSettingsToast: false })}\n          message={`已套用app連結中的設定，是否還原設定？`}\n          buttons={[\n            {\n              text: '取消',\n              role: 'cancel',\n              handler: () => this.setState({ showRestoreAppSettingsToast: false })\n            },\n            {\n              text: '還原',\n              handler: () => this.restoreAppSettings(),\n            },\n          ]}\n        />\n\n        <IonToast\n          cssClass='uiFont'\n          isOpen={this.state.showToast}\n          onDidDismiss={() => this.setState({ showToast: false })}\n          message={this.state.toastMessage}\n          duration={2000}\n        />\n      </IonApp>\n    );\n  }\n}\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    shareTextModal: state.tmpSettings.shareTextModal,\n    settings: state.settings,\n  }\n};\n\nconst AppOrig = connect(\n  mapStateToProps,\n)(_AppOrig);\n\n\nconst App = withRouter(_App);\n\nexport default App;\n","import { /*applyMiddleware,*/ createStore, Store } from \"redux\";\n\n//import { logger } from \"redux-logger\"\n//import thunk from \"redux-thunk\"\n//import promise from \"redux-promise-middleware\"\n\nimport reducer from \"./reducers\";\nimport Globals from \"../Globals\";\n\n//const middleware = applyMiddleware(promise(), thunk, logger)\n\nvar savedStore: Store;\n\nexport default function getSavedStore() {\n    var savedSettingsStr = localStorage.getItem(Globals.storeFile);\n    if (savedSettingsStr != null) {\n        savedStore = createStore(reducer, JSON.parse(savedSettingsStr));//, middleware)\n    }\n    else {\n        savedStore = createStore(reducer);//, middleware)\n    }\n\n    return savedStore;\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      /*\n      if(registration.waiting) {\n        const reg = registration.waiting;\n        reg.postMessage({ type: 'SKIP_WAITING' });\n        alert('Skip waiting.');\n      }*/\n\n      registration.onupdatefound = () => {\n        //alert('onupdatefound.');\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          console.log(`installingWorker stage changed: ${installingWorker.state}`);\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from \"react-router-dom\";\nimport App, {serviceWorkCallbacks} from './App';\nimport Globals from './Globals';\nimport * as serviceWorker from './serviceWorkerRegistration';\n\n// Enable at the very start for logging most messages.\nGlobals.enableAppLog();\n\nReactDOM.render(<BrowserRouter><App /></BrowserRouter>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register({\n    onSuccess: (registration: ServiceWorkerRegistration) => { console.log('Precache app loaded!'); serviceWorkCallbacks.onSuccess(registration); },\n    onUpdate: (registration: ServiceWorkerRegistration) => { console.log('Found app updated!'); serviceWorkCallbacks.onUpdate(registration); },\n});\n"],"sourceRoot":""}